const isValidNoFunctions=require("../is-valid-no-functions/is-valid-no-functions"),isValidWithFunctions=e=>{if(/[a-z][a-z]+(?![a-z]*\()/.test(e))return!1;let s=e;for(;/[a-z]+\((?!.*[a-z]+\()/.test(s);){let e=s.match(/[a-z]+\((?!.*[a-z]+\()/),i=e.index+e[0].length,a=getClosePosition(s,i);if(-1===a)return!1;let t=s.slice(i,a);switch(e[0].slice(0,-1)){case"sin":case"sen":case"cos":case"tan":case"tg":case"sqrt":case"cbrt":case"ln":case"acos":case"asin":case"asen":case"atan":case"atg":case"exp":case"sinh":case"senh":case"cosh":case"tanh":case"tgh":case"asinh":case"acosh":case"atanh":case"atgh":case"factorial":case"fact":case"abs":if(!isValidNoFunctions(t))return!1;break;case"pow":case"nroot":case"max":case"min":if(!/,/.test(t))return!1;{let e=t.split(",");if(!isValidNoFunctions(e[0])||!isValidNoFunctions(e[1])||e.length>2)return!1}break;case"log":if(/,/.test(t)){let e=t.split(",");if(!isValidNoFunctions(e[0])||!isValidNoFunctions(e[1])||e.length>2)return!1}else if(!isValidNoFunctions(t))return!1;break;default:return!1}const n=e.index>0?s[e.index-1]:"",c=a<s.length-1?s.slice(a+1):"";s=/[\)\]\}\d]/.test(n)?/^[\(\[\{]|^[a-z][a-z]+\(/.test(c)?`${s.slice(0,e.index)}*1*${s.slice(a+1)}`:`${s.slice(0,e.index)}*1${s.slice(a+1)}`:/^\d+|^[\(\[\{]|^[a-z][a-z]+\(/.test(c)?`${s.slice(0,e.index)}1*${s.slice(a+1)}`:`${s.slice(0,e.index)}1${s.slice(a+1)}`}return isValidNoFunctions(s)};function getClosePosition(e,s){let i=1;for(let a=s;a<e.length;a++)if("("===e[a]&&i++,")"===e[a]&&i--,0===i)return a;return-1}module.exports=isValidWithFunctions;